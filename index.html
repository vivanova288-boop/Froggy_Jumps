<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: sans-serif; background: #2bbcd6; }
        #ui { position: absolute; top: 0; width: 100%; z-index: 10; }
        #header { padding: 15px; color: white; text-align: center; font-weight: bold; font-size: 20px; }
        #lives { position: absolute; top: 60px; left: 20px; display: flex; gap: 5px; }
        .life { width: 40px; height: 40px; background-size: contain; background-repeat: no-repeat; }
        #quest-box { background: white; width: 80%; margin: 20px auto; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        #pond { position: relative; height: 60vh; width: 100%; }
        .leaf { position: absolute; width: 150px; height: 120px; background-size: contain; background-repeat: no-repeat; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; text-shadow: 1px 1px 2px #000; }
        #frog { position: absolute; width: 80px; height: 80px; background-size: contain; background-repeat: no-repeat; z-index: 5; transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        #waiting { position: fixed; inset: 0; background: #2bbcd6; display: flex; align-items: center; justify-content: center; color: white; font-size: 40px; z-index: 100; }
        .shock { animation: shock 0.1s infinite; }
        @keyframes shock { 0% { filter: invert(1); transform: scale(1.1); } 100% { filter: invert(0); } }
    </style>
</head>
<body>
    <div id="waiting">ОЖИДАНИЕ НАСТРОЕК...</div>
    <div id="ui">
        <div id="header">ЗАГРУЗКА...</div>
        <div id="lives"></div>
        <div id="quest-box">
            <div id="question-text">Вопрос</div>
        </div>
    </div>
    <div id="pond"><div id="frog"></div></div>

    <script>
        let cfg;
        let currentLives;
        
        // Сигнал в Genially: "Я готов, давай настройки"
        window.onload = () => window.parent.postMessage('frog_ready', '*');

        // Получение настроек
        window.addEventListener('message', e => {
            if (e.data.qs) {
                cfg = e.data;
                document.getElementById('waiting').style.display = 'none';
                startGame();
            }
        });

        function startGame() {
            document.getElementById('header').innerText = cfg.t;
            document.getElementById('header').style.backgroundColor = cfg.v.c;
            currentLives = cfg.li;
            updateLives();
            document.getElementById('frog').style.backgroundImage = `url(${cfg.v.f})`;
            nextStep();
        }

        function updateLives() {
            const container = document.getElementById('lives');
            container.innerHTML = '';
            for(let i=0; i<currentLives; i++) {
                let d = document.createElement('div');
                d.className = 'life';
                d.style.backgroundImage = `url(${cfg.v.i})`;
                container.appendChild(d);
            }
        }

        function nextStep() {
            // Тут логика отрисовки листьев и прыжка
            // При ошибке: лягушка получает класс .shock и прыгает назад
        }
    </script>
</body>
</html>
