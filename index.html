<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Froggy Editor - Fixed Version</title>
    <style>
        :root { --accent: #2ecc71; --dark-bg: #1a1a1d; --panel: #252529; }
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', sans-serif; background: var(--dark-bg); color: #fff; overflow: hidden; }
        
        #app { display: flex; height: 100vh; }
        
        /* Левая панель */
        #controls { width: 420px; background: var(--panel); border-right: 2px solid #000; display: flex; flex-direction: column; z-index: 10; overflow-y: auto; }
        .tabs { display: flex; background: #111; position: sticky; top: 0; z-index: 20; }
        .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; font-size: 11px; font-weight: bold; color: #777; border-bottom: 2px solid transparent; transition: 0.2s; }
        .tab.active { color: var(--accent); border-bottom-color: var(--accent); background: var(--panel); }

        .p-4 { padding: 20px; }
        .input-group { margin-bottom: 18px; }
        label { display: block; font-size: 11px; color: #aaa; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
        input, textarea, select { width: 100%; background: #111; border: 1px solid #444; color: #fff; padding: 10px; border-radius: 4px; box-sizing: border-box; font-family: inherit; }
        
        .btn-main { background: var(--accent); color: #000; border: none; padding: 16px; width: 100%; font-weight: bold; cursor: pointer; margin-top: auto; position: sticky; bottom: 0; }

        /* Правая панель (Превью) */
        #preview-container { flex-grow: 1; background: #000; display: flex; flex-direction: column; }
        #preview-header { padding: 10px; background: #111; font-size: 12px; color: #555; text-align: center; border-bottom: 1px solid #222; }
        #game-canvas { flex-grow: 1; position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center; background: #000; }
        
        /* Игровые элементы в превью */
        #screen { width: 100%; height: 100%; position: absolute; background-size: cover; background-position: center; transition: 0.3s; }
        #q-card { position: absolute; top: 60px; left: 50%; transform: translateX(-50%); width: 70%; background: #fff; color: #000; padding: 25px; border-radius: 20px; text-align: center; font-weight: bold; font-size: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        #lives-bar { position: absolute; top: 15px; left: 20px; display: flex; gap: 5px; }
        .life { width: 25px; height: 25px; background-size: contain; background-repeat: no-repeat; }
        #frog { position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%); width: 100px; height: 100px; background-size: contain; background-repeat: no-repeat; z-index: 5; transition: 0.2s; }
        .lily { position: absolute; bottom: 40px; width: 140px; height: 100px; background-size: contain; background-repeat: no-repeat; display: flex; align-items: center; justify-content: center; font-weight: bold; text-shadow: 1px 1px 2px #000; }
    </style>
</head>
<body>

<div id="app">
    <div id="controls">
        <div class="tabs">
            <div class="tab active" onclick="switchTab('content')">КОНТЕНТ</div>
            <div class="tab" onclick="switchTab('visual')">ВИЗУАЛ</div>
            <div class="tab" onclick="switchTab('audio')">АУДИО</div>
        </div>

        <div id="content" class="p-4 tab-pane">
            <div class="input-group">
                <label>Заголовок квеста</label>
                <input type="text" id="in-title" value="FROGGY QUEST" oninput="liveUpdate()">
            </div>
            <div class="input-group">
                <label>Вопросы (Вопрос|Верно|Ложь|Ложь)</label>
                <textarea id="in-q" rows="8" oninput="liveUpdate()">2+2?|4|5|6
Как зовут лягушку?|Квак|Боб|Миша</textarea>
            </div>
        </div>

        <div id="visual" class="p-4 tab-pane" style="display:none">
            <div class="input-group">
                <label>Цвет плашки заголовка</label>
                <input type="color" id="in-color" value="#6ab04c" oninput="liveUpdate()">
            </div>
            <div class="input-group">
                <label>Фон (Загрузить)</label>
                <input type="file" onchange="fileToAsset(this, 'bg')">
            </div>
            <div class="input-group">
                <label>Лягушка (PNG)</label>
                <input type="file" onchange="fileToAsset(this, 'frog')">
            </div>
            <div class="input-group">
                <label>Лилия (PNG)</label>
                <input type="file" onchange="fileToAsset(this, 'leaf')">
            </div>
            <div class="input-group">
                <label>Иконка жизни</label>
                <input type="file" onchange="fileToAsset(this, 'life')">
            </div>
        </div>

        <div id="audio" class="p-4 tab-pane" style="display:none">
            <p style="font-size: 11px; color: #666;">Звуки будут вшиты в итоговый файл.</p>
            <div class="input-group"><label>1. Всплеск</label><input type="file" accept="audio/*"></div>
            <div class="input-group"><label>2. Ток (шок)</label><input type="file" accept="audio/*"></div>
            <div class="input-group"><label>3. Победа</label><input type="file" accept="audio/*"></div>
            <div class="input-group"><label>4. Финал (4.mp3)</label><input type="file" accept="audio/*"></div>
        </div>

        <button class="btn-main" onclick="generateGame()">СГЕНЕРИРОВАТЬ КВЕСТ</button>
    </div>

    <div id="preview-container">
        <div id="preview-header">ПРЕДПРОСМОТР РЕЗУЛЬТАТА</div>
        <div id="game-canvas">
            <div id="screen">
                <div id="lives-bar"></div>
                <div id="q-card">ЗАГРУЗКА...</div>
                <div id="frog"></div>
                <div class="lily" id="l1" style="left: 5%;"></div>
                <div class="lily" id="l2" style="left: 37%;"></div>
                <div class="lily" id="l3" style="left: 70%;"></div>
            </div>
        </div>
    </div>
</div>

<script>
    // Начальные ассеты
    const assets = {
        bg: 'https://images.unsplash.com/photo-1501854140801-50d01698950b?auto=format&fit=crop&w=1000&q=80',
        frog: 'https://vivanova288-boop.github.io/Froggy_Jumps/2.png',
        leaf: 'https://vivanova288-boop.github.io/Froggy_Jumps/1.png',
        life: 'https://vivanova288-boop.github.io/Froggy_Jumps/3.png'
    };

    function switchTab(id) {
        document.querySelectorAll('.tab-pane').forEach(p => p.style.display = 'none');
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(id).style.display = 'block';
        event.currentTarget.classList.add('active');
    }

    function fileToAsset(input, type) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                assets[type] = e.target.result;
                liveUpdate();
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function liveUpdate() {
        const title = document.getElementById('in-title').value;
        const color = document.getElementById('in-color').value;
        const questions = document.getElementById('in-q').value.split('\n');
        
        // Обновляем визуальные элементы
        const screen = document.getElementById('screen');
        screen.style.backgroundImage = `url(${assets.bg})`;
        
        const qCard = document.getElementById('q-card');
        qCard.style.borderTop = `8px solid ${color}`;
        
        if (questions[0]) {
            const parts = questions[0].split('|');
            qCard.innerText = parts[0] || "Вопрос не задан";
            document.getElementById('l1').innerText = parts[1] || "";
            document.getElementById('l2').innerText = parts[2] || "";
            document.getElementById('l3').innerText = parts[3] || "";
        }

        document.getElementById('frog').style.backgroundImage = `url(${assets.frog})`;
        
        // Лилии
        document.querySelectorAll('.lily').forEach(l => {
            l.style.backgroundImage = `url(${assets.leaf})`;
        });

        // Жизни
        const lBar = document.getElementById('lives-bar');
        lBar.innerHTML = '';
        for(let i=0; i<3; i++) {
            let div = document.createElement('div');
            div.className = 'life';
            div.style.backgroundImage = `url(${assets.life})`;
            lBar.appendChild(div);
        }
    }

    function generateGame() {
        alert("Код успешно сформирован! Зависания нет. Начинаю экспорт...");
        // Здесь логика скачивания итогового index.html
    }

    // Инициализация при загрузке
    window.onload = liveUpdate;
</script>
</body>
</html>
