<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Froggy Jumps Quiz</title>

    <style>
        :root {
            --water1: #2bbcd6;
            --water2: #168ea0;
            --ui-bg: #6ab04c;
        }

        html, body {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            overflow: hidden;
            font-family: 'Arial Rounded MT Bold', Arial, sans-serif;
            background: #2bbcd6 url('bg.png') no-repeat center center fixed;
            background-size: cover;
        }

        /* ---------- UI ---------- */
        #ui-layer {
            position: absolute; top: 0; width: 100%; z-index: 1000; pointer-events: none;
        }
        #header {
            background: var(--ui-bg); color: white; padding: 10px;
            text-align: center; font-weight: bold; pointer-events: auto;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        #lives-container {
            position: absolute; top: 50px; left: 20px;
            display: flex; gap: 8px; pointer-events: auto;
        }
        .life-icon {
            width: 40px; height: 40px;
            background: url('3.png') no-repeat center / contain;
        }
        #question-box {
            background: white; width: 85%; max-width: 500px;
            margin: 15px auto; padding: 15px; border-radius: 18px;
            text-align: center; box-shadow: 0 8px 20px rgba(0,0,0,0.25);
            pointer-events: auto;
        }
        .timer-bar { width: 100%; height: 10px; background: #dfe6e9; border-radius: 5px; margin-top: 10px; overflow: hidden; }
        #timer-fill { width: 100%; height: 100%; background: #eb4d4b; transition: width 0.1s linear; }

        /* ---------- WORLD ---------- */
        #world { position: absolute; inset: 0; padding-top: 120px; }
        #pond { position: relative; width: 100%; height: 100%; }

        /* ---------- LEAVES ---------- */
        .leaf {
            position: absolute; width: 120px; height: 100px;
            background: url('1.png') no-repeat center / contain;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold; color: white; text-align: center;
            font-size: 18px; text-shadow: 1px 1px 2px black;
            transition: transform 0.3s, filter 0.3s;
            cursor: pointer; padding: 10px; box-sizing: border-box;
        }
        .leaf.active { transform: scale(1.1); filter: drop-shadow(0 0 10px gold); }
        .leaf.active::after {
            content: attr(data-letter); position: absolute; top: -10px;
            background: #f1c40f; color: black; border-radius: 50%;
            width: 25px; height: 25px; display: flex; align-items: center; justify-content: center;
        }

        /* ---------- FROG ---------- */
        #frog {
            position: absolute; width: 80px; height: 80px;
            background: url('2.png') no-repeat center / contain;
            z-index: 999; pointer-events: none;
            transform: translate(-50%, -60%);
            transition: left 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275), 
                        top 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* –®–û–ö –ò –û–®–ò–ë–ö–ê */
        @keyframes electric-shock {
            0% { filter: brightness(2) hue-rotate(180deg); transform: translate(-50%, -60%) scale(1.2) rotate(5deg); }
            50% { filter: brightness(3) hue-rotate(0deg); transform: translate(-50%, -60%) scale(1.2) rotate(-5deg); }
            100% { filter: brightness(1); }
        }
        .shock { animation: electric-shock 0.1s infinite; }

        /* ---------- OVERLAY ---------- */
        #overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            z-index: 2000; display: none; flex-direction: column;
            justify-content: center; align-items: center; color: white;
        }
        button {
            padding: 15px 40px; font-size: 20px; border-radius: 30px;
            border: none; background: var(--ui-bg); color: white; cursor: pointer;
        }

        /* VOLUME */
        #volume-control {
            position: absolute; bottom: 20px; right: 20px;
            background: white; padding: 10px; border-radius: 20px;
            display: flex; align-items: center; gap: 10px; z-index: 1001;
        }
    </style>
</head>
<body>

<div id="ui-layer">
    <div id="header">PAST SIMPLE CHALLENGE</div>
    <div id="lives-container"></div>
    <div id="question-box">
        <div id="q-text"><b>Get Ready!</b></div>
        <div class="timer-bar"><div id="timer-fill"></div></div>
    </div>
</div>

<div id="volume-control">
    <span>üîä</span>
    <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="0.5">
</div>

<div id="world">
    <div id="pond">
        <div id="frog"></div>
    </div>
</div>

<div id="overlay">
    <h1 id="msg">GAME OVER</h1>
    <button onclick="location.reload()">Restart Game</button>
</div>

<script>
const userConfig = window.frogGameConfig || {
    lives: 5,
    timer: 15,
    rawQuestions: `
        I ___ to the park yesterday | went | go | gone
        She ___ a song last night | sang | sing | sung
        They ___ at home | were | was | are
        We ___ football | played | play | plays
        He ___ a new car | bought | buy | buyed
    `
};

let currentStep = 0;
let lives = userConfig.lives;
let gameQuestions = [];
let timeLeft = userConfig.timer;
let timerInterval;
let globalVolume = 0.5;
let isJumping = false;

// –ó–≤—É–∫–∏ (–ø—É—Å—Ç—ã–µ –∑–∞–≥–ª—É—à–∫–∏, –µ—Å–ª–∏ —Ñ–∞–π–ª–æ–≤ –Ω–µ—Ç)
const sounds = {
    jump: new Audio('1.mp3'),
    error: new Audio('2.mp3'),
    win: new Audio('3.mp3'),
    over: new Audio('4.mp3')
};

function playSnd(s) {
    s.volume = globalVolume;
    s.currentTime = 0;
    s.play().catch(() => {});
}

// 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤
function parseQuestions() {
    const lines = userConfig.rawQuestions.trim().split('\n');
    return lines.map(line => {
        const parts = line.split('|').map(p => p.trim());
        const qText = parts[0];
        const correctAns = parts[1];
        const allOptions = parts.slice(1).sort(() => Math.random() - 0.5);
        return {
            q: qText,
            options: allOptions,
            correctIndex: allOptions.indexOf(correctAns)
        };
    });
}

// 2. –°–æ–∑–¥–∞–Ω–∏–µ –∫—É–≤—à–∏–Ω–æ–∫
function createPond() {
    const pond = document.getElementById('pond');
    const frog = document.getElementById('frog');
    
    for (let i = 0; i < gameQuestions.length + 1; i++) {
        const row = document.createElement('div');
        row.style.position = "absolute";
        row.style.width = "100%";
        row.style.bottom = (i * 120) + 50 + "px"; // –ò–¥–µ–º —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö
        row.style.display = "flex";
        row.style.justifyContent = "center";
        row.style.gap = "40px";

        if (i === 0) {
            // –°—Ç–∞—Ä—Ç–æ–≤—ã–π –ª–∏—Å—Ç
            const startLeaf = document.createElement('div');
            startLeaf.className = 'leaf';
            startLeaf.id = "step-0";
            row.appendChild(startLeaf);
            pond.appendChild(row);
            
            // –°—Ç–∞–≤–∏–º –ª—è–≥—É—à–∫—É –Ω–∞ —Å—Ç–∞—Ä—Ç
            setTimeout(() => moveFrogTo(startLeaf), 100);
        } else {
            // –õ–∏—Å—Ç—å—è —Å –æ—Ç–≤–µ—Ç–∞–º–∏
            const qData = gameQuestions[i-1];
            qData.options.forEach((opt, idx) => {
                const leaf = document.createElement('div');
                leaf.className = 'leaf active';
                leaf.innerText = opt;
                leaf.setAttribute('data-letter', ['A','B','C'][idx]);
                leaf.onclick = () => handleJump(i, idx, leaf);
                row.appendChild(leaf);
            });
            pond.appendChild(row);
        }
    }
}

function moveFrogTo(leaf) {
    const frog = document.getElementById('frog');
    const rect = leaf.getBoundingClientRect();
    const pondRect = document.getElementById('pond').getBoundingClientRect();
    
    frog.style.left = (rect.left + rect.width/2 - pondRect.left) + "px";
    frog.style.top = (rect.top + rect.height/2 - pondRect.top) + "px";
}

function handleJump(step, choiceIdx, leafElement) {
    if (isJumping || step !== currentStep + 1) return;
    
    isJumping = true;
    const frog = document.getElementById('frog');
    const correctIdx = gameQuestions[currentStep].correctIndex;
    
    // –ü—Ä—ã–≥–∞–µ–º –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ
    moveFrogTo(leafElement);
    playSnd(sounds.jump);

    setTimeout(() => {
        if (choiceIdx === correctIdx) {
            // –í–ï–†–ù–û
            currentStep++;
            if (currentStep === gameQuestions.length) {
                endGame("YOU WIN!", sounds.win);
            } else {
                nextQuestion();
            }
        } else {
            // –û–®–ò–ë–ö–ê: —ç—Ñ—Ñ–µ–∫—Ç —Ç–æ–∫–∞ –∏ –æ—Ç—Å–∫–æ–∫
            frog.classList.add('shock');
            playSnd(sounds.error);
            lives--;
            updateUI();

            setTimeout(() => {
                frog.classList.remove('shock');
                // –û—Ç—Å–∫–∞–∫–∏–≤–∞–µ–º –Ω–∞–∑–∞–¥ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ª–∏—Å—Ç
                const prevLeaf = document.getElementById(currentStep === 0 ? "step-0" : "current-leaf");
                moveFrogTo(prevLeaf);
                
                if (lives <= 0) {
                    endGame("GAME OVER", sounds.over);
                }
            }, 600);
        }
        isJumping = false;
    }, 600);
}

function nextQuestion() {
    clearInterval(timerInterval);
    const qData = gameQuestions[currentStep];
    document.getElementById('q-text').innerHTML = `<b>${qData.q}</b>`;
    
    // –ü–æ–º–µ—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –ª–∏—Å—Ç –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
    const allLeaves = document.querySelectorAll('.leaf');
    allLeaves.forEach(l => l.id = "");
    // –ù–∞—Ö–æ–¥–∏–º –ª–∏—Å—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Å–µ–π—á–∞—Å –ª—è–≥—É—à–∫–∞
    const activeRows = document.querySelectorAll('#pond > div');
    const currentRow = activeRows[currentStep];
    const currentLeaf = currentRow.querySelector('.leaf');
    currentLeaf.id = "current-leaf";

    startTimer();
}

function startTimer() {
    timeLeft = userConfig.timer;
    const fill = document.getElementById('timer-fill');
    timerInterval = setInterval(() => {
        timeLeft -= 0.1;
        fill.style.width = (timeLeft / userConfig.timer) * 100 + "%";
        if (timeLeft <= 0) {
            lives--;
            updateUI();
            if (lives <= 0) endGame("TIME'S UP!", sounds.over);
            else timeLeft = userConfig.timer;
        }
    }, 100);
}

function updateUI() {
    const container = document.getElementById('lives-container');
    container.innerHTML = "";
    for (let i = 0; i < lives; i++) {
        const heart = document.createElement('div');
        heart.className = 'life-icon';
        container.appendChild(heart);
    }
}

function endGame(text, snd) {
    clearInterval(timerInterval);
    playSnd(snd);
    document.getElementById('msg').innerText = text;
    document.getElementById('overlay').style.display = 'flex';
}

// –ì—Ä–æ–º–∫–æ—Å—Ç—å
document.getElementById('volume-slider').oninput = (e) => {
    globalVolume = e.target.value;
};

// –°—Ç–∞—Ä—Ç
window.onload = () => {
    gameQuestions = parseQuestions();
    updateUI();
    createPond();
    nextQuestion();
};
</script>

</body>
</html>
