<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Froggy Jumps Quiz</title>
<style>
    /* ТВОИ СТИЛИ ИЗ ЧАСТИ 1 (копируй полностью свой CSS блок сюда) */
    :root { --water1: #2bbcd6; --water2: #168ea0; --ui-bg: #6ab04c; }
    html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: Arial, sans-serif; background: url('bg.png') no-repeat center center fixed; background-size: cover; }
    #ui-layer { position: absolute; top: 0; width: 100%; z-index: 1000; pointer-events: none; }
    #header { background: var(--ui-bg); color: white; padding: 10px; text-align: center; font-weight: bold; pointer-events: auto; }
    #lives-container { position: absolute; top: 50px; left: 20px; display: flex; gap: 8px; pointer-events: auto; }
    .life-icon { width: 52px; height: 52px; background: url('3.png') no-repeat center / contain; transition: transform 0.2s; }
    #question-box { background: white; width: 85%; max-width: 500px; margin: 10px auto; padding: 12px; border-radius: 18px; text-align: center; box-shadow: 0 8px 20px rgba(0,0,0,0.25); pointer-events: auto; }
    .timer-bar { width: 100%; height: 8px; background: #dfe6e9; border-radius: 5px; margin-top: 8px; overflow: hidden; }
    #timer-fill { width: 100%; height: 100%; background: #eb4d4b; transition: width 0.1s linear; }
    #world { position: absolute; inset: 0; padding-top: 60px; overflow: hidden; }
    #pond { position: relative; width: 100%; height: 100%; margin: 0 auto; }
    .leaf { position: absolute; width: 20vw; height: 16vw; max-width: 180px; max-height: 150px; background: url('1.png') no-repeat center / contain; display: flex; align-items: center; justify-content: center; transform: scale(0.85); transition: transform 0.4s, opacity 0.4s; padding: 15px; box-sizing: border-box; text-align: center; font-size: 22px; color: white; font-weight: bold; text-shadow: 1px 1px 3px #000; }
    .leaf.active { opacity: 1; transform: scale(1.1); z-index: 10; cursor: pointer; filter: drop-shadow(0 0 15px #fff); }
    #frog { opacity: 0; position: absolute; width: 10vw; height: 10vw; max-width: 90px; background: url('2.png') no-repeat center / contain; transform: translate(-50%, -60%) scale(1.15); z-index: 999; pointer-events: none; }
    .shock { animation: electric-shock 0.1s infinite; z-index: 20 !important; }
    @keyframes electric-shock { 0% { filter: brightness(1.5) hue-rotate(180deg); transform: scale(1.1) translate(2px, 2px); } 100% { filter: brightness(1); } }
    #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 2000; display: none; flex-direction: column; justify-content: center; align-items: center; color: white; }
    .splash { position: absolute; border: 4px solid #fff; border-radius: 50%; transform: translate(-50%, -50%); animation: splash-ani 0.6s forwards; }
    @keyframes splash-ani { 0% { width: 0; height: 0; opacity: 1; } 100% { width: 150px; height: 80px; opacity: 0; } }
    .jumping-frog { transform: translate(-50%, -80%) scale(1.4) !important; filter: drop-shadow(0 30px 20px rgba(0,0,0,0.3)) !important; }
</style>
</head>
<body>
    <div id="countdown-overlay" style="display: flex; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 3000; justify-content: center; align-items: center; color: white; font-size: 100px; font-weight: bold;">ОЖИДАНИЕ...</div>
    <div id="ui-layer">
        <div id="header">ЗАГРУЗКА...</div>
        <div id="lives-container"></div>
        <div id="question-box">
            <div id="q-text">Подготовка...</div>
            <div class="timer-bar"><div id="timer-fill"></div></div>
        </div>
    </div>
    <div id="world"><div id="pond"><div id="frog"></div></div></div>
    <div id="overlay"><h1 id="msg"></h1><button onclick="location.reload()">Try Again</button></div>

<script>
let cfg, levelsBank = {}, currentLevel = 1, step = 0, lives = 5, timer, questions = [], globalVolume = 0.5;
const sounds = {};

// ЖДЕМ ДАННЫЕ ОТ GENIALLY
window.onload = () => window.parent.postMessage('ready', '*');
window.addEventListener('message', e => { 
    if(e.data.questions) { cfg = e.data; setupGame(); } 
});

function setupGame() {
    globalVolume = parseFloat(cfg.snd.v);
    lives = parseInt(cfg.lives);
    document.getElementById('header').innerText = cfg.title;
    
    // Распределяем вопросы по уровням
    for(let i=1; i<=cfg.lvls; i++) {
        levelsBank[i] = cfg.questions.slice((i-1)*cfg.qpl, i*cfg.qpl);
    }
    
    // Инициализируем звуки
    sounds.splash = new Audio(cfg.snd.s3);
    sounds.shock = new Audio(cfg.snd.s4);
    sounds.victory = new Audio(cfg.snd.s5);
    sounds.gameOver = new Audio(cfg.snd.s6);
    sounds.start = new Audio(cfg.snd.s2);
    sounds.levelUp = new Audio(cfg.snd.s1);
    sounds.count = new Audio(cfg.snd.s7);

    initGame();
}

// (Далее вставь всю свою логику из Части 2: createPond, initGame, handleJump и т.д.)
// ВАЖНО: В handleJump при ошибке лягушка должна прыгать на lastCorrectLeaf!
</script>
</body>
</html>
