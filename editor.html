<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Froggy Master Editor</title>
    <style>
        :root { --green: #6ab04c; --bg: #1e272e; --panel: #2f3640; }
        body { margin: 0; display: flex; height: 100vh; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; overflow: hidden; }
        
        /* Sidebar */
        #sidebar { width: 400px; background: var(--panel); padding: 20px; overflow-y: auto; border-right: 3px solid #000; }
        .card { background: #353b48; padding: 15px; margin-bottom: 20px; border-radius: 10px; border-left: 5px solid var(--green); }
        h2 { color: var(--green); margin-top: 0; font-size: 20px; border-bottom: 1px solid #444; padding-bottom: 10px; }
        h3 { font-size: 12px; color: #aaa; text-transform: uppercase; margin-top: 0; }
        
        label { display: block; font-size: 11px; margin: 10px 0 5px; color: #dcdde1; }
        input, select, textarea { width: 100%; padding: 8px; background: #191e24; border: 1px solid #444; color: #fff; border-radius: 5px; box-sizing: border-box; }
        
        .btn-copy { background: #eb4d4b; color: white; border: none; width: 100%; padding: 18px; font-weight: bold; cursor: pointer; border-radius: 5px; font-size: 16px; margin-top: 10px; transition: 0.3s; }
        .btn-copy:hover { background: #ff5e57; box-shadow: 0 0 15px rgba(235, 77, 75, 0.4); }

        /* Preview Area */
        #preview-cont { flex: 1; display: flex; flex-direction: column; background: #000; }
        iframe { flex: 1; border: none; width: 100%; height: 100%; background: #fff; }
        #status-bar { padding: 8px; font-size: 12px; text-align: center; background: #111; color: #555; }
    </style>
</head>
<body>

<div id="sidebar">
    <h2>FROGGY BUILDER</h2>

    <div class="card">
        <h3>1. Графика (PNG)</h3>
        <label>Лягушка (2.png)</label><input type="file" onchange="encode('frog', this)">
        <label>Лист (1.png)</label><input type="file" onchange="encode('leaf', this)">
        <label>Жизнь (3.png)</label><input type="file" onchange="encode('life', this)">
        <label>Фон (bg.png)</label><input type="file" onchange="encode('bg', this)">
        <label>Размер героя (%)</label><input type="range" id="v-size" min="30" max="150" value="90" oninput="update()">
    </div>

    <div class="card">
        <h3>2. Звуки (1-7.mp3)</h3>
        <label>1. Splash / 2. Shock / 3. Victory</label>
        <input type="file" multiple onchange="encodeAudio(this)">
        <p style="font-size: 9px; color: #777;">*Выберите сразу несколько файлов .mp3</p>
    </div>

    <div class="card">
        <h3>3. Настройки UI</h3>
        <label>Цвет шапки</label><input type="color" id="v-color" value="#6ab04c" oninput="update()">
        <label>Заголовок</label><input type="text" id="v-title" value="PAST SIMPLE CHALLENGE" oninput="update()">
        <label><input type="checkbox" id="v-glow" checked onchange="update()"> Свечение героя</label>
    </div>

    <button class="btn-copy" onclick="copyCode()">КОПИРОВАТЬ КОД ДЛЯ GENIALLY</button>
</div>

<div id="preview-cont">
    <div id="status-bar">ПРЕДПРОСМОТР ДВИЖКА</div>
    <iframe id="target"></iframe>
</div>

<script>
    let assets = { frog: '', leaf: '', life: '', bg: '' };
    let sounds = {};

    function encode(key, input) {
        const reader = new FileReader();
        reader.onload = (e) => { assets[key] = e.target.result; update(); };
        reader.readAsDataURL(input.files[0]);
    }

    function encodeAudio(input) {
        Array.from(input.files).forEach((file, index) => {
            const reader = new FileReader();
            reader.onload = (e) => { sounds['s' + (index + 1)] = e.target.result; };
            reader.readAsDataURL(file);
        });
    }

    function update() {
        const frame = document.getElementById('target');
        const color = document.getElementById('v-color').value;
        const title = document.getElementById('v-title').value;
        const size = document.getElementById('v-size').value;
        const glow = document.getElementById('v-glow').checked;

        // Здесь мы внедряем твой JS код, заменяя пути на base64 переменные
        const finalHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <style>
                /* Вставляем твои стили */
                :root { --ui-bg: ${color}; }
                body { margin: 0; background: url(${assets.bg}) no-repeat center/cover fixed; font-family: Arial; overflow: hidden; }
                #header { background: var(--ui-bg); color: white; padding: 10px; text-align: center; font-weight: bold; }
                .life-icon { width: 52px; height: 52px; background: url(${assets.life}) no-repeat center / contain; }
                .leaf { position: absolute; width: 150px; height: 120px; background: url(${assets.leaf}) no-repeat center / contain; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; font-weight: bold; text-shadow: 2px 2px 4px #000; cursor: pointer; transition: 0.3s; }
                #frog { position: absolute; width: ${size}px; height: ${size}px; background: url(${assets.frog}) no-repeat center / contain; transform: translate(-50%, -50%); z-index: 1000; transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); ${glow ? 'filter: drop-shadow(0 0 15px #fff);' : ''} pointer-events: none;}
                /* Твои анимации shock, sink и т.д. */
                @keyframes electric-shock { 0% { filter: brightness(2) hue-rotate(90deg); transform: translate(-50%, -55%) scale(1.2); } 100% { filter: brightness(1); } }
                .shock { animation: electric-shock 0.1s infinite; }
                #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); display: none; flex-direction: column; align-items: center; justify-content: center; color: white; z-index: 5000; }
                #question-box { background: white; width: 80%; margin: 10px auto; padding: 15px; border-radius: 15px; text-align: center; color: #333; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
            </style>
        </head>
        <body>
            <div id="header">${title}</div>
            <div id="lives-container" style="display:flex; padding: 10px;"></div>
            <div id="question-box"><div id="q-text">Ready?</div></div>
            <div id="pond" style="position:relative; height:80vh;">
                <div id="frog"></div>
            </div>
            <div id="overlay"><h1 id="msg"></h1><button onclick="location.reload()">Try Again</button><canvas id="fireworksCanvas"></canvas></div>

            <script>
                // ТВОЯ ЛОГИКА (из присланного кода)
                const sounds = {
                    start: new Audio("${sounds.s5 || ''}"),
                    shock: new Audio("${sounds.s2 || ''}"),
                    splash: new Audio("${sounds.s1 || ''}"),
                    victory: new Audio("${sounds.s3 || ''}"),
                    gameOver: new Audio("${sounds.s4 || ''}")
                };
                
                // Вставь сюда все функции из своего кода: handleJump, updateLives, createPond и т.д.
                // Для теста я добавлю базовую инициализацию:
                document.getElementById('q-text').onclick = () => alert('Game Started with your logic!');
            <\/script>
        </body>
        </html>`;

        frame.srcdoc = finalHTML;
    }

    function copyCode() {
        const iframeCode = `<iframe srcdoc='${document.getElementById('target').srcdoc.replace(/'/g, "&apos;")}' width="100%" height="600px" frameborder="0" scrolling="no"></iframe>`;
        navigator.clipboard.writeText(iframeCode);
        alert("КОД СКОПИРОВАН! Вставь его в Genially (Insert -> Others)");
    }
</script>
</body>
</html>
