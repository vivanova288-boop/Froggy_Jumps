<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Froggy Game Editor</title>

<style>
:root {
  --green:#2ecc71;
  --bg:#1e272e;
  --panel:#2f3640;
}
body{
  margin:0;
  display:flex;
  height:100vh;
  font-family:Arial, sans-serif;
  background:var(--bg);
  color:#fff;
}
#sidebar{
  width:380px;
  background:var(--panel);
  padding:15px;
  overflow-y:auto;
}
.card{
  background:#353b48;
  padding:12px;
  margin-bottom:12px;
  border-radius:8px;
  border-left:4px solid var(--green);
}
h2{
  font-size:14px;
  color:var(--green);
  margin:0 0 8px;
}
label{
  font-size:11px;
  color:#ccc;
  display:block;
  margin-top:6px;
}
input, textarea{
  width:100%;
  background:#1b1f24;
  color:#fff;
  border:1px solid #555;
  padding:6px;
  border-radius:4px;
}
textarea{
  height:70px;
  font-family:monospace;
  font-size:11px;
}
button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border:none;
  font-weight:bold;
  cursor:pointer;
  border-radius:6px;
}
.btn-preview{background:var(--green);}
.btn-copy{background:#e67e22;}
#preview{
  flex:1;
  background:#000;
}
iframe{
  width:100%;
  height:100%;
  border:none;
}
.sound-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:6px;
}
.toggle{
  display:flex;
  align-items:center;
  gap:6px;
  margin-top:6px;
}
</style>
</head>

<body>

<div id="sidebar">

<h2>FROGGY QUEST EDITOR</h2>

<div class="card">
  <label>Заголовок</label>
  <input id="title" value="FROGGY QUEST">

  <label>Вопросы (Вопрос|Верный|Ложный|Ложный)</label>
  <textarea id="questions">
I ___ a movie.|watched|watch|watches
She ___ to school.|went|go|goes
  </textarea>
</div>

<div class="card">
  <h2>ГРАФИКА</h2>
  <label>Лягушка</label><input type="file" onchange="img('frog',this)">
  <label>Лист</label><input type="file" onchange="img('leaf',this)">
  <label>Фон</label><input type="file" onchange="img('bg',this)">
  <label>Жизнь</label><input type="file" onchange="img('life',this)">
</div>

<div class="card">
  <h2>ЗВУКИ (7)</h2>
  <div class="sound-grid">
    <input type="file" onchange="snd('s1',this)">
    <input type="file" onchange="snd('s2',this)">
    <input type="file" onchange="snd('s3',this)">
    <input type="file" onchange="snd('s4',this)">
    <input type="file" onchange="snd('s5',this)">
    <input type="file" onchange="snd('s6',this)">
    <input type="file" onchange="snd('s7',this)">
  </div>
</div>

<div class="card">
  <h2>НАСТРОЙКИ ИГРЫ</h2>

  <label>Размер лягушки (px)</label>
  <input type="number" id="frogSize" value="80">

  <label>Скорость прыжка (мс)</label>
  <input type="number" id="jumpSpeed" value="500">

  <label>Жизни</label>
  <input type="number" id="lives" value="3">

  <label>Цвет заголовка</label>
  <input type="color" id="headerColor" value="#2ecc71">

  <div class="toggle">
    <input type="checkbox" id="glow">
    <label>Свечение</label>
  </div>

  <label>Цвет свечения</label>
  <input type="color" id="glowColor" value="#00ffcc">
</div>

<button class="btn-preview" onclick="update()">ОБНОВИТЬ ПРЕДПРОСМОТР</button>
<button class="btn-copy" onclick="copy()">СКОПИРОВАТЬ iframe</button>

</div>

<div id="preview">
  <iframe id="frame"></iframe>
</div>

<script>
const imgs = {}, sounds = {};

function img(k,i){
  const r=new FileReader();
  r.onload=e=>imgs[k]=e.target.result;
  r.readAsDataURL(i.files[0]);
}
function snd(k,i){
  const r=new FileReader();
  r.onload=e=>sounds[k]=e.target.result;
  r.readAsDataURL(i.files[0]);
}

function parseQ(){
  return document.getElementById('questions').value
  .split('\n')
  .filter(l=>l.includes('|'))
  .map(l=>{
    const [q,c,w1,w2]=l.split('|');
    const o=[c,w1,w2].sort(()=>Math.random()-0.5);
    return {q,options:o,correct:o.indexOf(c)};
  });
}

function build(){
  const cfg={
    title:val('title'),
    colors:{header:val('headerColor')},
    images:imgs,
    sounds:sounds,
    sizes:{frog:+val('frogSize')},
    speed:{jump:+val('jumpSpeed')},
    lives:+val('lives'),
    effects:{
      glow:el('glow').checked,
      glowColor:val('glowColor')
    },
    questions:parseQ()
  };

  return `
<!DOCTYPE html>
<html>
<head>
<style>
body{margin:0;background:url(${imgs.bg}) center/cover no-repeat;}
#frog{
 width:${cfg.sizes.frog}px;
 height:${cfg.sizes.frog}px;
 background:url(${imgs.frog}) center/contain no-repeat;
 position:absolute;
 transition:${cfg.speed.jump}ms;
 ${cfg.effects.glow?`filter:drop-shadow(0 0 15px ${cfg.effects.glowColor});`:``}
}
</style>
</head>
<body>

<script>
window.GAME_CONFIG=${JSON.stringify(cfg)};
<\/script>
<script src="index.html"><\/script>

</body>
</html>`;
}

function update(){
  document.getElementById('frame').srcdoc=build();
}

function copy(){
  const code=`<iframe srcdoc='${build().replace(/'/g,"&apos;")}' width="100%" height="600"></iframe>`;
  navigator.clipboard.writeText(code);
  alert("Готово для Genially");
}

const el=id=>document.getElementById(id);
const val=id=>el(id).value;
</script>

</body>
</html>
